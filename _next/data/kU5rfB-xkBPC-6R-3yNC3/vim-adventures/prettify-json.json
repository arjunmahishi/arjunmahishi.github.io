{"pageProps":{"postData":{"id":"prettify-json","contentHTML":"<html><head></head><body><h3 id=\"tldr\"><a class=\"anchor\" href=\"#tldr\">TL;DR</a></h3>\n<div class=\"remark-highlight\"><pre class=\"language-vim\"><code class=\"language-vim\">au <span class=\"token keyword\">filetype</span> json nmap <span class=\"token operator\">&#x3C;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">f</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">%</span><span class=\"token operator\">!</span>jq <span class=\"token string\">'.'</span> <span class=\"token operator\">%</span><span class=\"token operator\">&#x3C;</span>CR<span class=\"token operator\">></span>\n</code></pre></div>\n<h3 id=\"challenge\"><a class=\"anchor\" href=\"#challenge\">Challenge</a></h3>\n<p>If you have ever opened a large auto-generated JSON file, you probably would have wanted to pull your hair out. To be able to read it easily, you would have to copy the whole thing, open an online JSON formatting tool, paste it, get the formatted output and read it.</p>\n<p>I knew that <code>jq</code> can be used on CLI to format JSON, so I wanted to use that from within vim to do the formatting and skip the above circus.</p>\n<h3 id=\"solution\"><a class=\"anchor\" href=\"#solution\">Solution</a></h3>\n<p>If you are a regular vim user, then you probably also are a regular CLI user. So, there is a good chance that you have heard of <code>jq</code> and used it before. If not, <a href=\"https://stedolan.github.io/jq/\">check it out here</a> NOW!</p>\n<p>On the CLI, the most common way to use <code>jq</code> to format JSON is with this command <code>jq '.' &#x3C;file_name></code>. This gives the entire JSON object with proper indentation. Try it:</p>\n<div class=\"remark-highlight\"><pre class=\"language-vim\"><code class=\"language-vim\">echo <span class=\"token string\">'{\"key1\": \"val1\", \"key2\": \"val2\"}'</span> | jq <span class=\"token string\">'.'</span>\n</code></pre></div>\n<p>Now, how do we run this from within vim?</p>\n<p>If you don't already know, vim has a command mode that allows you to run vim commands (more about it <a href=\"https://www.freecodecamp.org/news/vim-editor-modes-explained/\">here</a>). It also allows us to run bash commands. This is done by prefixing the command with a bang (<code>!</code>). Try running this <code>:!echo \"hello world\"</code> in command mode. Similarly, run the <code>jq</code> command:</p>\n<div class=\"remark-highlight\"><pre class=\"language-vim\"><code class=\"language-vim\"><span class=\"token punctuation\">:</span><span class=\"token operator\">%</span><span class=\"token operator\">!</span>jq <span class=\"token string\">'.'</span> <span class=\"token operator\">%</span>\n</code></pre></div>\n<p>Wondering what the hell <code>%</code> is for?</p>\n<p><code>%</code> refers to the current file's name. Try running <code>:!echo %</code>. It will print the current file's name. So, the <code>%</code> at the end is to pass the current file's name to the <code>jq</code> command as an argument. The first <code>%</code> tells vim to replace the contents of the current buffer with the output of the following command.</p>\n<p>One final step -- create a key mapping so that you won't have to type the whole command every time. Add this to your vimrc/init.vim:</p>\n<div class=\"remark-highlight\"><pre class=\"language-vim\"><code class=\"language-vim\">au <span class=\"token keyword\">filetype</span> json nmap <span class=\"token operator\">&#x3C;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">f</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">%</span><span class=\"token operator\">!</span>jq <span class=\"token string\">'.'</span> <span class=\"token operator\">%</span><span class=\"token operator\">&#x3C;</span>CR<span class=\"token operator\">></span>\n</code></pre></div>\n<p>This will map <code>, + f</code> (<code>,</code> is my <code>&#x3C;leader></code> key) to the above <code>jq</code> command when the file type is JSON.</p>\n<p>Hope that helps :)</p>\n</body></html>","title":"Prettify JSON in Vim","date":"2021-10-10","tags":["vim"]}},"__N_SSG":true}