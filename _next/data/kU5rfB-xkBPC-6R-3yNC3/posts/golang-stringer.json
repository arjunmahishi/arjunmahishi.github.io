{"pageProps":{"postData":{"id":"golang-stringer","contentHTML":"<html><head></head><body><p><strong>Straight from the documentation:</strong></p>\n<blockquote>\n<p>Stringer is a tool to automate the creation of methods that satisfy the fmt.Stringer interface. Given the name of a (signed or unsigned) integer type T that has constants defined, stringer will create a new self-contained Go source file implementing:</p>\n<h1 id=\"func-t-t-string-string\"><a class=\"anchor\" href=\"#func-t-t-string-string\">func (t T) String() string</a></h1>\n<p>The file is created in the same package and directory as the package that defines T. It has helpful defaults designed for use with go generate.</p>\n</blockquote>\n<p>Stringer is among other Golang tools which help us in writing good go code. This is a CLI tool which is used via <code>go generate</code>. Go generate is another tool that comes with go. It is used for auto-generating code. You can explore more about it <a href=\"https://golang.org/pkg/cmd/go/internal/generate/\" target=\"_blank\" rel=\"noreferrer\">in their documentation</a>.</p>\n<p>So, we use the stringer command with go generate to generate the code necessary to implement fmt’s stringer interface. Conceptually this is very simple. But the documentation for stringer is, well there is no documentation. There is only a help flag in the stringer command which only lists the available flags we can use with stringer. These flags are very useful but are ignored by many people. They give us control over how the final output string is formatted.</p>\n<h2 id=\"what-stringer-is-used-for\"><a class=\"anchor\" href=\"#what-stringer-is-used-for\">What stringer is used for</a></h2>\n<p>Stringer is generally used to implement the concept of enumeration while avoiding hard-coding of the string values. Enumeration or enum is when you want to define a finite and fixed set of values of a given type. For example, types of dishes in a menu (appetizers, main course, desserts), types of pokemon (grass, water, fire, ..), etc.</p>\n<p>So, when we want to use these defined sets of values, we should avoid hard coding them as it can lead to human errors like spelling mistakes. If we use something like stringer, we will generate the values once and make sure there are no errors. After that, we can just use them without worrying about human errors.</p>\n<h2 id=\"hands-on\"><a class=\"anchor\" href=\"#hands-on\">Hands-on</a></h2>\n<p>The types that we define as enums will be extending <code>int</code>. So, when we declare the variables for each element, they will hold <code>int</code> values (value1 = 1, value2 = 2, etc). These <code>int</code> values will be used by stringer internally to index the values. But, we don’t have to manually initialise the <code>int</code> value for each of the elements. Go provides an identifier called <code>iota</code> to incrementally initialise <code>int</code> values. Let’s look at an example for <code>iota</code>.</p>\n<p>type Sample int</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n\tvalue1 Sample <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span>\n\tvalue2\n\tvalue3\n\tvalue4\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// or if you want the values</span>\n<span class=\"token comment\">// to start from 1</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n\tvalue5 Sample <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n\tvalue6\n\tvalue7\n\tvalue8\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>Let's go over each of the flags stringer has and see how they can be used with some examples.</p>\n<h3 id=\"-type\"><a class=\"anchor\" href=\"#-type\">-type</a></h3>\n<p><code>-type</code> is a compulsory argument which defines which type the string belongs to. This argument also supports a list of comma-separated type names. The <code>String()</code> method will be generated for all the given types. But this method’s definition will be put in a separate file. This file will by default be named <code>&#x3C;type>_string.go</code> . Let’s look at an example for the <code>-type</code> :</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> HeroType <span class=\"token builtin\">int</span>\n<span class=\"token keyword\">type</span> AttackType <span class=\"token builtin\">int</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n\tStrength HeroType <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n\tAgility\n\tIntelligence\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n\tMelee AttackType <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n\tRanged\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">//go:generate stringer -type=HeroType,AttackType</span>\n</code></pre></div>\n<p>Both the String() definitions will be put in a single file called herotype_string.go . If we want them to be in separate files, we will need to have two go generate comments like this:</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token comment\">//go:generate stringer -type=HeroType</span>\n<span class=\"token comment\">//go:generate stringer -type=AttackType</span>\n</code></pre></div>\n<p>This will create two files: <code>herotype_string.go</code> and <code>attacktype_string.go</code> . To generate these files, we need to run the command <code>go generate</code> in the same directory. This will create the files. And every time we run go generate , these files will be regenerated. So, it is important that we do not edit these generated files manually as they will get overwritten.</p>\n<h3 id=\"-output\"><a class=\"anchor\" href=\"#-output\">-output</a></h3>\n<p><code>-output</code> flag is used to explicitly specify the name of the file what will be generated. This will override the default name <code>&#x3C;type>_string.go</code> . That’s pretty much all this flag does. So, for the above example, if we wanted to put both the type’s generations into a single file called <code>hero-attack_string.go</code>, we can use the <code>-output</code> flag like this:</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token comment\">//go:generate stringer -type=HeroType,AttackType -output=hero-attack_string.go</span>\n</code></pre></div>\n<p>This will generate the single  <code>hero-attack_string.go</code> with both the <code>String()</code> definitions.</p>\n<h3 id=\"-trimprefix\"><a class=\"anchor\" href=\"#-trimprefix\">-trimprefix</a></h3>\n<p>Sometimes, we would want to name the enum variables descriptively with a prefix, to make the code more readable (Ex: <code>HeroTypeAgility</code> instead of just <code>Agility</code>). But this exact name would get reflected in the final output string. We can use the <code>-trimprefix</code> to avoid this and trim the prefix before generating the final string output. This will trim the specified prefix and only use the rest of the text as the value.</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> HeroType <span class=\"token builtin\">int</span>\n\n<span class=\"token comment\">//go:generate stringer -type=HeroType -trimprefix=HeroType</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n    HeroTypeStrength HeroType <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n    HeroTypeAgility\n    HeroTypeIntelligence\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>This will generate the <code>String()</code> function which return the above values with “HeroType” trimmed off: “Strength”, “Agility”, “Intelligence”</p>\n<h3 id=\"-linecomment\"><a class=\"anchor\" href=\"#-linecomment\">-linecomment</a></h3>\n<p>This flag, like <code>trimprefix</code> is also used for customising what the <code>String()</code> function returns.<code>trimprefix</code> only lets you trim of the prefix of the value, but this flag lets you set WHATEVER value you want to a particular object of that type. This custom value is set by adding a comment on the same line as the object, with the value you want to set. Example:</p>\n<div class=\"remark-highlight\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> Artist <span class=\"token builtin\">int</span>\n\n<span class=\"token comment\">//go:generate stringer -type=Artist -linecomment</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n    ArtistLedZeppelin Artist <span class=\"token operator\">=</span> <span class=\"token boolean\">iota</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token comment\">// led-zepplin</span>\n    ArtistPinkFloyd                     <span class=\"token comment\">// pink-floyd</span>\n    ArtistPostMalone                    <span class=\"token comment\">// post-malone</span>\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>This will generate enums with the values: “led-zeppelin”, “pink-floyd” and “post-malone”. This way, we can have “-” in the string value. <code>linecomment</code> is generally used in cases like this when we want to have special characters, start the value with a lower case, keep the variable camel-case and the values snake-case etc.</p>\n<blockquote>\n<p>NOTE: The comment has to be on the same line. And the space after // is ignored</p>\n</blockquote>\n<h3 id=\"-tags\"><a class=\"anchor\" href=\"#-tags\">-tags</a></h3>\n<p>This flag is used to specify the build tags. These build tags are used for conditionally generate the <code>String()</code> function. I am not very sure about how to specifically use this. I tried to find out, but couldn’t find much online. If you know any examples, please comment below.</p>\n<p>These are the flags available in <code>stringer</code>. This is a fairly simple tool to use. Hope this post give you more clarity about it.</p>\n</body></html>","title":"Using Golang's Stringer tool","date":"2020-01-28","tags":["golang","tools","good-practices"]}},"__N_SSG":true}