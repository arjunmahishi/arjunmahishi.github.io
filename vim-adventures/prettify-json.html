<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Prettify JSON in Vim | Arjun Mahishi</title><link rel="icon" href="/favicon.ico"/><meta name="description" content="Arjun Mahishi&#x27;s personal website"/><meta property="og:title" content="Prettify JSON in Vim"/><meta property="og:description" content=""/><meta property="og:image" content="/img/dp.jpg"/><meta property="og:url" content="https://arjunmahishi.me"/><meta property="og:type" content="blog"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@arjunmahishi"/><meta name="twitter:creator" content="@arjunmahishi"/><meta name="twitter:title" content="Prettify JSON in Vim"/><meta name="twitter:description" content=""/><meta name="twitter:image" content="/img/dp.jpg"/><link rel="preload" href="https://unpkg.com/prismjs@0.0.1/themes/prism-okaidia.css" as="script"/><link href="/gruvbox.css" rel="stylesheet"/><meta name="next-head-count" content="18"/><link rel="preload" href="/_next/static/css/1e7eac4066826e90.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1e7eac4066826e90.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-481ef0d25a716735.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8eb925bbcba34840.js" defer=""></script><script src="/_next/static/chunks/209-e125b2166f138b3f.js" defer=""></script><script src="/_next/static/chunks/pages/vim-adventures/%5Bid%5D-89ce2c2775279db2.js" defer=""></script><script src="/_next/static/uwdC6iWM-7ud-pXpO8LKL/_buildManifest.js" defer=""></script><script src="/_next/static/uwdC6iWM-7ud-pXpO8LKL/_ssgManifest.js" defer=""></script></head><body><div id="__next">  <div class="grid place-items-center"><div class="flex flex-col items-center"><h1 class="text-center text-4xl font-bold mb-4"><a class="underline decoration-2 underline-offset-4" href="/">ಅರ್ಜುನ್ ಮಹಿಷಿ</a></h1><nav><ul class="flex flex-wrap justify-center gap-2"><li class="mx-2 inline-block align-text-bottom"><a class="underline underline-offset-4 decoration-2" href="/about">About</a></li><li class="mx-2 inline-block align-text-bottom"><a class="underline underline-offset-4 decoration-2" href="/projects">Projects</a></li><li class="mx-2 inline-block align-text-bottom"><a class="underline underline-offset-4 decoration-2" href="/posts">Blog</a></li><li class="mx-2 inline-block align-text-bottom"><a class="underline underline-offset-4 decoration-2" href="/vim-adventures">Vim-Adventures</a></li><li class="mx-2 inline-block align-text-bottom"><a class="underline underline-offset-4 decoration-2" href="/maps">Maps</a></li></ul></nav></div><div class="prose lg:max-w-2xl lg:prose-lg px-8 m-auto my-4 sm:my-16 prose-img:rounded-xl"><h1 class="">Prettify JSON in Vim</h1></div><img alt="Prettify JSON in Vim" class="lg:max-w-3xl rounded-xl" style="display:none"/><article class="prose lg:max-w-2xl lg:prose-lg px-8 m-auto my-4 sm:my-16 prose-img:rounded-xl"><html><head></head><body><h3 id="tldr"><a class="anchor" href="#tldr">TL;DR</a></h3>
<div class="remark-highlight"><pre class="language-vim"><code class="language-vim">au <span class="token keyword">filetype</span> json nmap <span class="token operator">&#x3C;</span>leader<span class="token operator">></span><span class="token keyword">f</span> <span class="token punctuation">:</span><span class="token operator">%</span><span class="token operator">!</span>jq <span class="token string">'.'</span> <span class="token operator">%</span><span class="token operator">&#x3C;</span>CR<span class="token operator">></span>
</code></pre></div>
<h3 id="challenge"><a class="anchor" href="#challenge">Challenge</a></h3>
<p>If you have ever opened a large auto-generated JSON file, you probably would have wanted to pull your hair out. To be able to read it easily, you would have to copy the whole thing, open an online JSON formatting tool, paste it, get the formatted output and read it.</p>
<p>I knew that <code>jq</code> can be used on CLI to format JSON, so I wanted to use that from within vim to do the formatting and skip the above circus.</p>
<h3 id="solution"><a class="anchor" href="#solution">Solution</a></h3>
<p>If you are a regular vim user, then you probably also are a regular CLI user. So, there is a good chance that you have heard of <code>jq</code> and used it before. If not, <a href="https://stedolan.github.io/jq/">check it out here</a> NOW!</p>
<p>On the CLI, the most common way to use <code>jq</code> to format JSON is with this command <code>jq '.' &#x3C;file_name></code>. This gives the entire JSON object with proper indentation. Try it:</p>
<div class="remark-highlight"><pre class="language-vim"><code class="language-vim">echo <span class="token string">'{"key1": "val1", "key2": "val2"}'</span> | jq <span class="token string">'.'</span>
</code></pre></div>
<p>Now, how do we run this from within vim?</p>
<p>If you don't already know, vim has a command mode that allows you to run vim commands (more about it <a href="https://www.freecodecamp.org/news/vim-editor-modes-explained/">here</a>). It also allows us to run bash commands. This is done by prefixing the command with a bang (<code>!</code>). Try running this <code>:!echo "hello world"</code> in command mode. Similarly, run the <code>jq</code> command:</p>
<div class="remark-highlight"><pre class="language-vim"><code class="language-vim"><span class="token punctuation">:</span><span class="token operator">%</span><span class="token operator">!</span>jq <span class="token string">'.'</span> <span class="token operator">%</span>
</code></pre></div>
<p>Wondering what the hell <code>%</code> is for?</p>
<p><code>%</code> refers to the current file's name. Try running <code>:!echo %</code>. It will print the current file's name. So, the <code>%</code> at the end is to pass the current file's name to the <code>jq</code> command as an argument. The first <code>%</code> tells vim to replace the contents of the current buffer with the output of the following command.</p>
<p>One final step -- create a key mapping so that you won't have to type the whole command every time. Add this to your vimrc/init.vim:</p>
<div class="remark-highlight"><pre class="language-vim"><code class="language-vim">au <span class="token keyword">filetype</span> json nmap <span class="token operator">&#x3C;</span>leader<span class="token operator">></span><span class="token keyword">f</span> <span class="token punctuation">:</span><span class="token operator">%</span><span class="token operator">!</span>jq <span class="token string">'.'</span> <span class="token operator">%</span><span class="token operator">&#x3C;</span>CR<span class="token operator">></span>
</code></pre></div>
<p>This will map <code>, + f</code> (<code>,</code> is my <code>&#x3C;leader></code> key) to the above <code>jq</code> command when the file type is JSON.</p>
<p>Hope that helps :)</p>
</body></html></article></div><footer class="text-center text-gray-500 text-sm mt-5 pb-2">Built from scratch with <!-- --> <a class="underline decoration-dashed underline-offset-4 decoration-2" href="https://nextjs.org/">Next.js</a> and <!-- --> <a class="underline decoration-dashed underline-offset-4 decoration-2" href="https://tailwindcss.com/">Tailwind CSS</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"prettify-json","contentHTML":"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003ch3 id=\"tldr\"\u003e\u003ca class=\"anchor\" href=\"#tldr\"\u003eTL;DR\u003c/a\u003e\u003c/h3\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-vim\"\u003e\u003ccode class=\"language-vim\"\u003eau \u003cspan class=\"token keyword\"\u003efiletype\u003c/span\u003e json nmap \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eleader\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ef\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ejq \u003cspan class=\"token string\"\u003e'.'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eCR\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"challenge\"\u003e\u003ca class=\"anchor\" href=\"#challenge\"\u003eChallenge\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eIf you have ever opened a large auto-generated JSON file, you probably would have wanted to pull your hair out. To be able to read it easily, you would have to copy the whole thing, open an online JSON formatting tool, paste it, get the formatted output and read it.\u003c/p\u003e\n\u003cp\u003eI knew that \u003ccode\u003ejq\u003c/code\u003e can be used on CLI to format JSON, so I wanted to use that from within vim to do the formatting and skip the above circus.\u003c/p\u003e\n\u003ch3 id=\"solution\"\u003e\u003ca class=\"anchor\" href=\"#solution\"\u003eSolution\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eIf you are a regular vim user, then you probably also are a regular CLI user. So, there is a good chance that you have heard of \u003ccode\u003ejq\u003c/code\u003e and used it before. If not, \u003ca href=\"https://stedolan.github.io/jq/\"\u003echeck it out here\u003c/a\u003e NOW!\u003c/p\u003e\n\u003cp\u003eOn the CLI, the most common way to use \u003ccode\u003ejq\u003c/code\u003e to format JSON is with this command \u003ccode\u003ejq '.' \u0026#x3C;file_name\u003e\u003c/code\u003e. This gives the entire JSON object with proper indentation. Try it:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-vim\"\u003e\u003ccode class=\"language-vim\"\u003eecho \u003cspan class=\"token string\"\u003e'{\"key1\": \"val1\", \"key2\": \"val2\"}'\u003c/span\u003e | jq \u003cspan class=\"token string\"\u003e'.'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, how do we run this from within vim?\u003c/p\u003e\n\u003cp\u003eIf you don't already know, vim has a command mode that allows you to run vim commands (more about it \u003ca href=\"https://www.freecodecamp.org/news/vim-editor-modes-explained/\"\u003ehere\u003c/a\u003e). It also allows us to run bash commands. This is done by prefixing the command with a bang (\u003ccode\u003e!\u003c/code\u003e). Try running this \u003ccode\u003e:!echo \"hello world\"\u003c/code\u003e in command mode. Similarly, run the \u003ccode\u003ejq\u003c/code\u003e command:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-vim\"\u003e\u003ccode class=\"language-vim\"\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ejq \u003cspan class=\"token string\"\u003e'.'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWondering what the hell \u003ccode\u003e%\u003c/code\u003e is for?\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e%\u003c/code\u003e refers to the current file's name. Try running \u003ccode\u003e:!echo %\u003c/code\u003e. It will print the current file's name. So, the \u003ccode\u003e%\u003c/code\u003e at the end is to pass the current file's name to the \u003ccode\u003ejq\u003c/code\u003e command as an argument. The first \u003ccode\u003e%\u003c/code\u003e tells vim to replace the contents of the current buffer with the output of the following command.\u003c/p\u003e\n\u003cp\u003eOne final step -- create a key mapping so that you won't have to type the whole command every time. Add this to your vimrc/init.vim:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-vim\"\u003e\u003ccode class=\"language-vim\"\u003eau \u003cspan class=\"token keyword\"\u003efiletype\u003c/span\u003e json nmap \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eleader\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ef\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ejq \u003cspan class=\"token string\"\u003e'.'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eCR\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis will map \u003ccode\u003e, + f\u003c/code\u003e (\u003ccode\u003e,\u003c/code\u003e is my \u003ccode\u003e\u0026#x3C;leader\u003e\u003c/code\u003e key) to the above \u003ccode\u003ejq\u003c/code\u003e command when the file type is JSON.\u003c/p\u003e\n\u003cp\u003eHope that helps :)\u003c/p\u003e\n\u003c/body\u003e\u003c/html\u003e","title":"Prettify JSON in Vim","date":"2021-10-10","tags":["vim"]}},"__N_SSG":true},"page":"/vim-adventures/[id]","query":{"id":"prettify-json"},"buildId":"uwdC6iWM-7ud-pXpO8LKL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>